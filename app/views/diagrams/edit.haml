%h1 Editing problem
/- form_for(@diagram, :builder => LabelingFormBuilder) do |f|       
- Formtastic::SemanticFormBuilder.default_text_field_size = 50
= simple_form_for @diagram do |f|
  /= f.error_messages
  #first.span-12
    = f.input :position, :label => 'FEN', |
      :hint => 'English notation for FEN ("S" for Knight allowed): “2S5/1bQKpR2/4s3/…”' |
    .label Position (w/b)                                                          
    = f.input :white, :label => false, |
      :hint => '↕ FIDE notation: “Ka7 De1 Tf2 Lh3 Sh2 [p]e2 …”' |
    = f.input :black, :label => false

    #divBlank= image_tag '/fen', :id => 'blank'
    #pcount
    - %w{◁ ▽ △ ▷ CW CCW ↕}.each do |direction|
      = button_to_function direction, "moveBoard('#{direction}')"

    = f.input :stipulation, :input_html => {:class => 'c30p'}, :hint => '#2 | s#3 | h#2.5 | win | …'
    = f.input :twin, :hint => 'b) Se5->e6 | b) +Th3, c) Sh8<->La2 | 2.1;1.1 | …'
    =link_to_function 'Add fairy condition', "addFairyCondition()", :style => @hideIfFairy, :id => 'showfairy'
    #fairy(style = "#{@showIfFairy}")
      =f.input :fairy, :input_html => {:size => 20}, :hint => 'e.g. Circe, Andernach, Sentinels, …', :label => 'Fairy conditions'
    = f.check_box :tested, :label => 'C+'
  #second.span-12.last
    .label Authors
    #authors
      = render partial: 'author', collection: @diagram.authors
    %p
      = add_author_link "Add author"
    = f.input :source
    %table.zero
      %tr
        %td= f.input :label, hint: 'Diagram ID, label', input_html: {size: 10}
        %td= f.input :published, as: :date, input_html: {class: 'c30p'}, hint: '-'
    = f.input :solution, input_html: {rows: 25, cols: 5}, hint: 'Please adhere to FIDE piece notation: KDTLS.'
    /
      %ul.menu
        %li
          = link_to 'Don\'t save', @diagram
        %li
          = link_to 'Back to list', diagrams_path

  .clear.em1
  = f.submit 'Save'
  %fieldset
    %legend
      -#= submit_to_remote 'solve', ' Solve with popeye ', |
      = submit 'solve', ' Solve with popeye ', |
        :update => 'solution', :condition => 'validateForm()', |
        :before => "$('solution').update('Popeye solving in progres...')", |
        :method => 'post', :url => { :action => 'solve' }, :html => {:class => 'x'} |
    %label(for = "pyconds" class = "modest") Popeye “condition” line
    =text_field_tag :pyconds, @diagram.fairy, :class => "c30p"
    %span.fine circe, andernach, madrasi, masand, koeko, …
    %br
    %label(for = "pyopts" class = "modest") Popeye “options” line
    =text_field_tag :pyopts, "", :class => "c30p"
    %span.fine try, setplay, duplex, maxsolutions, intelligent, …   
    #solution<>
      %span.fine Popeye solution will go here (first run may be slow)
%p.fine
  Entered by
  = @diagram.user ? @diagram.user.name : 'computer'
  %script
    PIECE = '';
    $('#diagram_white').bind('keyup', updateFen);
    $('#diagram_black').bind('keyup', updateFen);
    $('#diagram_position').bind('keyup', updateFromFen);

    initVars();
    ; if (! $('#diagram_position').val())
    { updateFen({keyCode: 50})
    } else {
    updateFromFen()
    }

    \//   $('blank').src = '/fen/' + $('#diagram_fen').value;
    $('#diagram_white').focus();
    
